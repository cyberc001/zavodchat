Все методы принимают аргументы в виде query ("квери").

Квери оформляется следующим образом: после URI ресурса ставится '?', затем первый аргумент, где имя и значение разделены '='.

Потом идут дополнительные аргументы. Перед каждым дополнительным аргументом сначала ставится '&', затем таким же образом, через '=', разделяются имя и значение.

Подробнее: [https://en.wikipedia.org/wiki/Query_string](https://en.wikipedia.org/wiki/Query_string).

Например, для метода auth:
```
https://localhost/auth?username=test&password=qwe123
```

Примечания:
* Если перед типом значения аргумента стоит вопросительный знак (?int), это значит, что аргумент опциональный.
* Все методы, которые требуют аргумент "token", могут вернуть ошибку 401, если пользователь использует неизвестный/истёкший токен, или 400, если пользователь отправил невалидный (не UUID) токен . В таком случае надо попробовать авторизоваться заново, возможно через сохранённый логин/пароль. Если ошибка повторяется, выкинуть пользователя на экран авторизации.
* Все методы `/servers/$id/...` могут вернуть ошибку 403, если пользователь не состоит на сервере, или не имеет достаточно прав на изменение его настроек; также они могут вернуть ошибку 404, если сервера не существует. В документации эти ошибки не указываются.
* Все методы `/servers/$id/channels/$id/...` могут вернуть ошибку 403, если пользователь не имеет достаточно прав на изменение канала; также они могут вернуть ошибку 404, если канала не существует. В документации эти ошибки не указываются.
* Истёкшие приглашения и сессии периодически удаляются из базы данных.

## /auth

**GET:**

Вход в систему по логину/паролю.

*arguments:*
* username: string<br>
Логин
* password: string<br>
Пароль

*response 200:*

Авторизация прошла успешно.

body: `<UUID токена>`

*response 404:*

Неверный логин / пароль.

**PUT:**

Регистрация в системе.

*arguments:*
* username: string<br>
Логин
* displayname: string<br>
Отображаемое имя
* password: string<br>
Пароль

*response 200:*

Регистрация прошла успешно.

*response 403:*

Пользователь с таким именем уже существует.

**POST:**

Изменение данных пользователя.

*arguments:*
* username: ?string
* displayname: ?string
* password: ?string
* avatar: ?file

*response 200:*

Данные успешно изменены.

## /users/$id

**GET:**

Получить информацию о пользователе.

*response 200:*

body: JSON-объект с информацией о пользователе.
```
{
	"id": 412,
	"name": "cyb3rc001",
	"avatar": "123.12.53.45/avatar_453912.png",
	"status": "online"
}
```
*response 404:*

Пользователя с таким $id не существует.

## /servers

**GET:**

Получить список серверов, в которых состоит пользователь.

*arguments:*
* token: string

*response 200:*

body: JSON-массив из объектов - информации о каждом сервере.

см. `/servers/$id GET`

**PUT:**

Создать сервер

*arguments:*
* token: string
* name: string<br>
Имя сервера
	
*response 200:*

body: `<ID созданного сервера>`

*response 403:*

Превышено ограничение на количество серверов, которыми владеет пользователь.

body: `<причина ошибки>`

## /servers/$id

**GET:**

Получить информацию о сервере

*arguments:*
* token: string

*response 200:*

body: JSON-объект с информацией о севрере.
```
{
	"name": "zona bikini",
	"avatar": "123.12.53.45/avatar_453912.png"
}
```

**POST:**

Изменить настройки сервера

*arguments:*
* token: string
* name: ?string<br>
Имя сервера
* owner_id: ?int<br>
ID нового владельца сервера
* avatar: ?file

*response 400:*

Слишком длинное имя сервера.

*response 403:*

Пользователь с идентификатором owner_id не состоит на сервере.

*response 202:*

Пользователь с идентификатором owner_id уже является владельцем сервера.

*response 200:*

Сервер успешно изменён.


**DELETE:**

Удалить сервер

*arguments:*
* token: string
	
*response 200:*

Сервер успешно удалён.

## /servers/$id/users

**GET:**

Получить список пользователей в определённом диапазоне индексов.

*arguments:*
* token: string
* start: int<br>
Индекс, с которого начинается получение пользователей.
* count: int<br>
Количество получаемых пользователей.

*response 200:*

body: JSON-массив из объектов - информации о каждом пользователей. Если count выходит за пределы массива пользователей, то метод возвращает столько пользователей, сколько возможно.

см. `/users/$id GET`

*response 403:*
* Неправильный (< 0 или >= количеству пользователей) индекс.
* count не поддерживается сервером (> 50).

body: `<причина ошибки>`

## /servers/$id/users/$id

**DELETE:**

Выгнать пользователя с сервера.

*arguments:*
* token: string

*response 200:*

Пользователь был выгнан с сервера.

*response 403:*

Нет прав владельца / попытка выгнать самого себя (владельца сервера).

*response 404:*

Пользователь не является участником сервера.
	
## /servers/$id/channels

**GET:**

Получить список каналов

*arguments:*
* token: string

*response 200:*

body: JSON-массив из объектов - информации о каждом канале.

см. `/servers/$id/channels/$id GET`

**PUT:**

Создать канал

*arguments:*
* token: string
* name: string<br>
Имя канала
* type: int<br>
Тип канала - 0 (текстовый) или 1 (голосовой)

*response 200:*

body: `<ID созданного канала>`

*response 403:*

Превышено ограничение на количество каналов на сервере.

body: `<причина ошибки>`

## /servers/$id/channels/$id

**GET:**

Получить информацию о канале

*arguments:*
* token: string

*response 200:*

body: JSON-объект с информацией о канале.

Пример:
```
{
	"id": 2,
	"name": "channel_test_vc"
	"type": 1,
	"vc_users": [1, 2]
}
```

Поле "type" принимает значения:
* 0 - текстовый канал
* 1 - голосовой канал

Если канал голосовой и к нему присоединились пользователи, в объекте присутствует поле "vc_users", которое содержит массив из ID этих пользователей.

**POST:**

Изменить параметры канала

*arguments:*
* token: string
* name: ?string<br>
Имя канала
* type: ?int<br>
Тип канала - 0 (текстовый) или 1 (голосовой)

*response 200:*

Параметры успешно изменены.

**DELETE:**

Удалить канал

*arguments:*
* token: string

*response 200:*

Канал успешно удалён.

## /servers/$id/channels/$id/messages

**GET:**

Получить сообщения в определённом диапазоне индексов.

*arguments:*
* token: string
* start: int<br>
Индекс, с которого начинается получение сообщений.
* count: int<br>
Количество получаемых сообщений.
* order: ?int<br>
Порядок сортировки сообщений (0 - от новых к старым (по умолчанию), 1 - от старых к новым).

*response 200:*

body: JSON-массив из объектов - информации о каждом сообщении. Если count выходит за пределы массива сообщений, то метод возвращает столько сообщений, сколько возможно.

см. `/servers/$id/channels/$id/messages/$id GET`

*response 403:*
* Отрицательный индекс.
* count не поддерживается сервером (> 50).
* Канал не является текстовым.

body: `<причина ошибки>`

**PUT:**

Отправить сообщение в канал.

*arguments:*
* token: string
* text: string

*response 200:*

body: `ID созданного сообщения`

## /servers/$id/channels/$id/messages/$id

**GET:**

Получить информацию о сообщении с определённым ID.

*arguments:*
* token: string

*response 200:*

body: JSON-объект с информацией о сообщении.

Пример:
```
{
	"author_id": 1
	"edited": "2024-11-09 22:25:28.021376+03"
	"id": 1
	"sent": "2024-11-09 22:25:28.021376+03",
	"text": "папа ты купил молоко?"
}
```

**POST:**

Отредактировать текст сообщения с определённым ID.

*arguments:*
* token: string
* text: string

*response 200:*

Сообщение успешно отредактировано.

*response 403:*

Пользователь не является автором сообщения.

**DELETE:**

Удалить сообщение с определённым ID.

*arguments:*
* token: string

*response 200:*

Сообщение успешно удалено.

*response 403:*

Пользователь не является автором сообщения или владельцем сервера.

## /server_invites/$invite_id

**GET:**

Вступить на сервер по приглашению.

*arguments:*
* token: string

*response 200:*

Пользователь был принят на сервер.

*response 202:*

Пользователь уже состоит на сервере.

*response 404:*

Приглашение истекло / пользователь забанен.

## /servers/$server_id/invites

**GET:**

Получить список приглашений на сервер.

*arguments:*
* token: string

*response 200:*

body: JSON-массив со списком приглашений.

см. `/servers/$server_id/invites/$invite_id`

*response 403:*

Пользователь не является администратором сервера.

**PUT:**

Создать приглашение.

*arguments:*
* token: string
* expires: string<br>
Дата и время, когда приглашение истекает, в формате `YY-MM-DD hh:mm:ss+tz`.<br>
Например "2024-11-13 12:50:15+03", 03 - часовой пояс.<br>
Может быть `never`, тогда приглашение не истекает.

*response 200:*

body: `ID приглашения`

*response 400:*

Неправильный формат даты и времени истечения приглашения.

*response 403:*

На сервере слишком много приглашений (20).

## /servers/$server_id/invites/$invite_id

**GET:**

Получить информацию о приглашении на сервер.

*arguments:*
* token: string

*response 200:*

body: JSON-объект с информацией о приглашении.

Пример:
```
{
	"expires": "2024-11-13 00:00:00+03",
	"id": "1e1d184c-679a-494e-ba30-6f1f72bd221e"
	"server_id": 1
}
```

*response 403:*

Пользователь не является администратором сервера.

*response 404:*

Приглашения с таким ID не существует на этом сервере.

**POST:**

Изменить параметры приглашения.

*arguments:*
* token: string
* expires: string?

*response 200:*

Приглашение успешно изменено.

*response 400:*

Неправильный формат даты и времени истечения приглашения.

*response 404:*

Приглашения с таким ID не существует на этом сервере.

**DELETE:**

Удалить приглашение.

*arguments:*
* token: string

*response 200:*

Приглашение успешно удалено.

*response 403:*

Пользователь не является администратором сервера.

*response 404:*

Приглашения с таким ID не существует на этом сервере.

## /servers/$id/bans

**GET:**

Получить забаненных пользователей в определённом диапазоне индексов.

*arguments:*
* token: string
* start: int<br>
Индекс, с которого начинается получение банов.
* count: int<br>
Количество получаемых банов.

*response 200:*

body: JSON-массив из объектов - информации о каждом забаненном пользователе. Если count выходит за пределы массива банов, то метод возвращает столько банов, сколько возможно.

см. `/users/$id GET`

*response 403:*
* Отрицательный индекс.
* count не поддерживается сервером (> 50).

body: `<причина ошибки>`

**PUT:**

Забанить пользователя.

*arguments:*
* token: string
* expires: string<br>
Дата и время, когда бан перестаёт действовать, в формате `YY-MM-DD hh:mm:ss+tz`.<br>
Например "2024-11-13 12:50:15+03", 03 - часовой пояс.<br>
Может быть `never` - бан навсегда.
* ban\_user\_id: int

*response 200:*

Пользователь был забанен.

*response 202:*

Пользователь уже забанен.

*response 400:*

Неправильная дата истечения бана (или отсутствует).

*response 403:*

Нет прав владельца, либо попытка забанить владельца сервера.

## /servers/$id/bans/$id

**DELETE:**

Разбанить пользователя.

*arguments:*
* token: string

*response 200:*

Пользователь был разабанен.

*response 403:*

Нет прав владельца сервера.


## /files/avatar/user/$filename

**GET:**

Получить файл - аватарку пользователя.

*response 200:*

Файл в contents в двоичном виде.

*response 404:*

Файл не существует.

## /files/avatar/server/$filename

**GET:**

Получить файл - аватарку сервера.

*response 200:*

Файл в contents в двоичном виде.

*response 404:*

Файл не существует.
